{% extends 'members/base.html' %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
    <h1 class="mb-4">{{ page_title }}</h1>
    <div class="card mb-4">
        <div class="card-header">
            <h5>የአባላት ማጣሪያ</h5>
        </div>
        <div class="card-body">
            <form method="get" action="">
                <div class="row g-3">
                    <div class="col-md-4">
                        <input type="text" name="query" class="form-control" placeholder="በስም ወይም በመለያ ቁጥር ፈልግ" value="{{ request.GET.query }}">
                    </div>
                    <div class="col-md-3">
                        <input type="text" name="region" class="form-control" placeholder="በክልል ፈልግ" value="{{ request.GET.region }}">
                    </div>
                    <div class="col-md-2">
                        <input type="date" name="start_date" class="form-control" title="የተቀላቀለበት መጀመሪያ ቀን" value="{{ request.GET.start_date }}">
                    </div>
                    <div class="col-md-2">
                        <input type="date" name="end_date" class="form-control" title="የተቀላቀለበት መጨረሻ ቀን" value="{{ request.GET.end_date }}">
                    </div>
                    <div class="col-md-1">
                        <button type="submit" class="btn btn-primary w-100">ፈልግ</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="d-flex justify-content-end mb-3">
    <a href="{% url 'export_members_csv' %}?{{ request.GET.urlencode }}" class="btn btn-success">
        ሪፖርት በ Excel (CSV) አውርድ
    </a>
</div>
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th scope="col">ሙሉ ስም</th>
                    <th scope="col">የአባልነት መለያ</th>
                    <th scope="col">ስልክ ቁጥር</th>
                    <th scope="col">ክልል</th>
                    <th scope="col">ዝርዝር መረጃ</th>
                </tr>
            </thead>
            <tbody>
                {% for member in members %}
                <tr>
                    <td>{{ member.full_name }}</td>
                    <td><span class="badge bg-secondary">{{ member.membership_id }}</span></td>
                    <td>{{ member.phone_number }}</td>
                    <td>{{ member.address_region }}</td>
                    <td><a href="{% url 'member_detail' member.pk %}" class="btn btn-primary btn-sm">ዝርዝር እይ</a></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center">ምንም አይነት አባል አልተገኘም።</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}